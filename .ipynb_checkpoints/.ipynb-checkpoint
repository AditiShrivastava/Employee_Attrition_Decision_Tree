{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      satisfaction_level  last_evaluation  number_project  \\\n",
      "0                   0.10             0.90               7   \n",
      "1                   0.89             0.93               4   \n",
      "2                   0.38             0.50               2   \n",
      "3                   0.95             0.71               4   \n",
      "4                   0.84             0.84               5   \n",
      "5                   0.76             0.94               4   \n",
      "6                   0.55             0.88               4   \n",
      "7                   0.85             0.49               4   \n",
      "8                   0.17             0.85               3   \n",
      "9                   0.66             0.85               5   \n",
      "10                  0.63             0.61               4   \n",
      "11                  0.88             0.55               4   \n",
      "12                  0.20             0.68               5   \n",
      "13                  0.68             0.55               6   \n",
      "14                  0.41             0.63               2   \n",
      "15                  0.89             0.97               4   \n",
      "16                  0.93             0.87               3   \n",
      "17                  0.91             0.77               3   \n",
      "18                  0.61             0.85               4   \n",
      "19                  0.99             0.60               3   \n",
      "20                  0.94             0.51               4   \n",
      "21                  0.58             0.72               5   \n",
      "22                  0.67             0.86               3   \n",
      "23                  0.71             0.60               4   \n",
      "24                  0.87             0.48               4   \n",
      "25                  0.91             0.79               4   \n",
      "26                  0.55             0.40               3   \n",
      "27                  0.71             0.97               3   \n",
      "28                  0.64             0.40               3   \n",
      "29                  0.66             0.48               3   \n",
      "...                  ...              ...             ...   \n",
      "8960                0.83             0.51               4   \n",
      "8961                0.42             0.75               3   \n",
      "8962                0.69             0.82               4   \n",
      "8963                0.91             0.81               3   \n",
      "8964                0.93             0.70               5   \n",
      "8965                0.65             0.75               3   \n",
      "8966                0.50             0.50               3   \n",
      "8967                0.50             0.83               4   \n",
      "8968                0.74             0.91               4   \n",
      "8969                0.97             0.50               3   \n",
      "8970                0.98             0.53               3   \n",
      "8971                0.11             0.94               6   \n",
      "8972                0.10             0.86               6   \n",
      "8973                0.78             0.93               4   \n",
      "8974                0.09             0.87               5   \n",
      "8975                0.87             0.87               4   \n",
      "8976                0.20             0.58               5   \n",
      "8977                0.84             0.85               3   \n",
      "8978                0.60             0.49               3   \n",
      "8979                0.91             0.56               4   \n",
      "8980                0.14             0.56               5   \n",
      "8981                0.74             0.62               3   \n",
      "8982                0.90             0.60               3   \n",
      "8983                0.72             0.85               5   \n",
      "8984                0.12             0.50               5   \n",
      "8985                0.58             0.91               3   \n",
      "8986                0.10             0.93               6   \n",
      "8987                0.88             0.66               4   \n",
      "8988                0.80             0.95               5   \n",
      "8989                0.87             0.98               3   \n",
      "\n",
      "      average_montly_hours  time_spend_company  Work_accident  left  \\\n",
      "0                      286                   4              0     1   \n",
      "1                      249                   3              0     0   \n",
      "2                      132                   3              0     1   \n",
      "3                      151                   4              0     0   \n",
      "4                      163                   3              0     0   \n",
      "5                      168                   6              0     0   \n",
      "6                      252                   3              0     0   \n",
      "7                      139                   2              0     0   \n",
      "8                      168                   4              0     0   \n",
      "9                      271                   4              0     0   \n",
      "10                     171                   3              0     0   \n",
      "11                     205                   4              0     0   \n",
      "12                     167                   7              0     0   \n",
      "13                     181                   3              0     0   \n",
      "14                     145                   2              0     0   \n",
      "15                     147                   2              0     0   \n",
      "16                     154                   3              1     0   \n",
      "17                     195                   7              0     0   \n",
      "18                     273                   3              0     0   \n",
      "19                     262                   2              0     0   \n",
      "20                     229                   2              1     0   \n",
      "21                     234                   3              1     0   \n",
      "22                     175                   3              0     0   \n",
      "23                     208                   3              0     0   \n",
      "24                     133                   2              0     0   \n",
      "25                     254                   2              0     0   \n",
      "26                     139                   8              0     0   \n",
      "27                     219                   3              0     0   \n",
      "28                     248                   3              0     0   \n",
      "29                     192                   3              1     0   \n",
      "...                    ...                 ...            ...   ...   \n",
      "8960                   199                   3              0     0   \n",
      "8961                   218                   4              0     1   \n",
      "8962                   252                   3              1     0   \n",
      "8963                   220                   3              1     0   \n",
      "8964                   231                   7              0     0   \n",
      "8965                   194                   4              1     0   \n",
      "8966                   237                   2              0     0   \n",
      "8967                   242                   2              0     0   \n",
      "8968                   232                   5              0     1   \n",
      "8969                   188                   3              1     0   \n",
      "8970                   234                   3              0     0   \n",
      "8971                   286                   4              0     1   \n",
      "8972                   283                   4              0     1   \n",
      "8973                   225                   5              0     1   \n",
      "8974                   263                   4              0     1   \n",
      "8975                   144                   3              0     0   \n",
      "8976                   199                   4              0     0   \n",
      "8977                   153                   4              0     0   \n",
      "8978                   239                   2              0     0   \n",
      "8979                   158                   3              0     0   \n",
      "8980                   259                   4              1     0   \n",
      "8981                   216                   3              1     0   \n",
      "8982                   268                   3              0     0   \n",
      "8983                   244                   6              0     1   \n",
      "8984                   287                   4              0     0   \n",
      "8985                   223                   2              0     0   \n",
      "8986                   289                   4              1     1   \n",
      "8987                   275                   3              0     0   \n",
      "8988                   244                   5              0     1   \n",
      "8989                   174                   3              0     0   \n",
      "\n",
      "      promotion_last_5years        sales  salary  \n",
      "0                         0        sales     low  \n",
      "1                         0        sales     low  \n",
      "2                         0   accounting     low  \n",
      "3                         0        sales  medium  \n",
      "4                         0    technical     low  \n",
      "5                         0    technical  medium  \n",
      "6                         0   management     low  \n",
      "7                         0        sales  medium  \n",
      "8                         0           IT     low  \n",
      "9                         0  product_mng     low  \n",
      "10                        0        sales     low  \n",
      "11                        0  product_mng     low  \n",
      "12                        0    marketing  medium  \n",
      "13                        0           IT  medium  \n",
      "14                        0  product_mng     low  \n",
      "15                        0    technical     low  \n",
      "16                        0           IT     low  \n",
      "17                        0        sales  medium  \n",
      "18                        0        RandD     low  \n",
      "19                        0    marketing     low  \n",
      "20                        0        sales     low  \n",
      "21                        0        sales     low  \n",
      "22                        0           IT     low  \n",
      "23                        0   accounting    high  \n",
      "24                        0        RandD  medium  \n",
      "25                        0      support    high  \n",
      "26                        1           hr  medium  \n",
      "27                        0    technical    high  \n",
      "28                        0  product_mng  medium  \n",
      "29                        0        sales     low  \n",
      "...                     ...          ...     ...  \n",
      "8960                      0      support     low  \n",
      "8961                      0   management  medium  \n",
      "8962                      0           IT  medium  \n",
      "8963                      0      support     low  \n",
      "8964                      1        sales    high  \n",
      "8965                      0        sales     low  \n",
      "8966                      0    technical  medium  \n",
      "8967                      0      support  medium  \n",
      "8968                      0    technical  medium  \n",
      "8969                      0        sales     low  \n",
      "8970                      0        sales  medium  \n",
      "8971                      0           IT  medium  \n",
      "8972                      0      support     low  \n",
      "8973                      0        sales  medium  \n",
      "8974                      0           IT     low  \n",
      "8975                      0      support     low  \n",
      "8976                      0        sales     low  \n",
      "8977                      0   accounting     low  \n",
      "8978                      0        sales  medium  \n",
      "8979                      0    technical  medium  \n",
      "8980                      0           IT     low  \n",
      "8981                      0        sales     low  \n",
      "8982                      0        sales     low  \n",
      "8983                      0        sales     low  \n",
      "8984                      0    technical     low  \n",
      "8985                      0    technical     low  \n",
      "8986                      0      support     low  \n",
      "8987                      0        sales  medium  \n",
      "8988                      0        sales  medium  \n",
      "8989                      0           hr     low  \n",
      "\n",
      "[8990 rows x 10 columns]\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "eps = np.finfo(float).eps\n",
    "from numpy import log2 as log\n",
    "data = pd.read_csv(\"train.csv\")\n",
    "train,validate = np.split(data,[int(.8*len(data))])\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "def find_entropy(df):\n",
    "    Class = \"left\"   #To make the code generic, changing target variable class name\n",
    "    entropy = 0\n",
    "    values = df[Class].unique()\n",
    "    for value in values:\n",
    "        fraction = df[Class].value_counts()[value]/float(len(df[Class]))\n",
    "        entropy += -fraction*np.log2(fraction)\n",
    "    return entropy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "root = find_entropy(train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "def find_entropy_attribute(df,attribute):\n",
    "  Class = \"left\"   #To make the code generic, changing target variable class name\n",
    "  target_variables = df[Class].unique()  #This gives all 'Yes' and 'No'\n",
    "  variables = df[attribute].unique()    #This gives different features in that attribute (like 'Hot','Cold' in Temperature)\n",
    "  entropy2 = 0\n",
    "  for variable in variables:\n",
    "      entropy = 0\n",
    "      for target_variable in target_variables:\n",
    "          num = len(df[attribute][df[attribute]==variable][df[Class] ==target_variable])\n",
    "          den = len(df[attribute][df[attribute]==variable])\n",
    "          fraction = num/(den+eps)\n",
    "          entropy += -fraction*log(fraction+eps)\n",
    "      fraction2 = den/len(df)\n",
    "      entropy2 += -fraction2*entropy\n",
    "  return abs(entropy2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.005218505255885408\n"
     ]
    }
   ],
   "source": [
    "sales = find_entropy_attribute(train,\"sales\")\n",
    "gain = root - sales\n",
    "print(gain)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
